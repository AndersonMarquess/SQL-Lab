-- Estrutura
USE CURSOSQL01;

CREATE TABLE IF NOT EXISTS VENDAS (
	ID INT PRIMARY KEY AUTO_INCREMENT,
	NOME VARCHAR(50),
	SEXO CHAR(1),
	JANEIRO FLOAT (10,2),
	FEVEIRO FLOAT (10,2),
	MARCO FLOAT (10,2)
);

INSERT INTO VENDAS VALUES 
(NULL, 'A','F', 4560.54, 45647, 9978.50),
(NULL, 'B','M',6642.54,3986,995432.50),
(NULL, 'C','F',7878.54,4523,9923.50),
(NULL, 'D','M',386.54,9836,99453.50),
(NULL, 'D','F',8757.54,9836,78978.50);

SELECT * FROM VENDAS;
-- Solução 01 - Max, trazendo todo conteúdo da tupla 
SELECT V2.* FROM VENDAS V2
INNER JOIN (
	SELECT  V.SEXO, MAX(V.JANEIRO) AS JANEIRO FROM VENDAS V GROUP BY V.SEXO
) V3
ON V2.SEXO = V3.SEXO AND V2.JANEIRO = V3.JANEIRO;


-- Solução 02 - Max, trazendo todo conteúdo da tupla
SELECT V.* FROM VENDAS V
LEFT outer JOIN 
	VENDAS V2
ON
	V.SEXO = V2.SEXO AND V.JANEIRO < V2.JANEIRO
WHERE
	V2.ID IS NULL;

-- Truncate para formatar casas decimais
SELECT
	AVG (JANEIRO) AS MEDIA,
	TRUNCATE (AVG(JANEIRO), 2) AS MEDIA_FORMATADA,
	FORMAT (AVG(JANEIRO), 2,'DE_DE') AS MEDIA_COMO_REAIS
FROM
	VENDAS;